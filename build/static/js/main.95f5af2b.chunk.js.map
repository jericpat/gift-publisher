{"version":3,"sources":["../node_modules/tableschema/lib/profiles sync /^/.*/.json$","components/ProgressBar/index.jsx","utils/index.js","components/InputFile/index.jsx","assets/upload.png","components/InputUrl/index.jsx","components/Choose/index.jsx","components/Upload/index.jsx","components/TablePreview/index.jsx","components/TableSchema/index.jsx","components/ResourceList/index.jsx","components/Metadata/index.jsx","progressBar.svg","App.js","index.js"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","ProgressBar","props","useState","offset","setOffset","circleRef","useRef","size","progress","strokeWidth","circleOneStroke","circleTwoStroke","timeRemaining","center","radius","circumference","Math","PI","useEffect","current","style","className","width","height","stroke","cx","cy","r","ref","strokeDasharray","strokeDashoffset","x","y","floor","onFormatBytes","bytes","decimals","k","dm","sizes","i","log","parseFloat","pow","toFixed","InputFile","onChangeHandler","type","name","onChange","src","alt","InputUrl","onChangeUrl","htmlFor","onBlur","onKeyDown","event","keyCode","target","blur","handleKeyPress","placeholder","Choose","uploadOption","setUploadOption","onClick","Upload","a","state","formattedSize","selectedFile","path","files","length","storeFile","setState","uploadedFileType","value","match","setErrorState","validFileSelected","then","resp","validFile","errorMsg","file","self","hash","onHashProgress","assign","descriptor","hasSameSchema","_descriptor","hasSameHash","rows","sample_stream","toArray","sample","slice","text","readfile1","headerLength","indexOf","removeHeader","dataFile","File","copyFile","data","hashCopy","column_names","tablePreviewColumns","item","Header","accessor","tablePreviewSample","forEach","temp_obj","field","push","metadataHandler","loaded","success","fileExists","error","uploadToFileStorageHandler","uploadToFileCopyStorageHandler","handleUploadStatus","loading","this","catch","fileType","Promise","reject","split","pop","fetch","addSchema","console","hashInProgress","hashLoaded","onUploadProgress","progressEvent","Number","total","onTimeRemaining","uploadInProgress","progressLoaded","kbps","Date","getTime","start","fileSize","resource","dataset","includes","resources","newFields","schema","fields","oldFields","JSON","stringify","organizationId","lfsServerUrl","client","Client","upload","datasetId","response","message","copySelectedFile","newResource","round","React","Component","TablePreview","columns","useTable","getTableProps","headerGroups","prepareRow","TableHead","headerGroup","TableRow","getHeaderGroupProps","headers","column","TableCell","getHeaderProps","render","TableBody","row","getRowProps","cells","cell","getCellProps","osTypesPath","osTypesDescPath","TableSchema","osTypes","userOSTypes","setUserOSTypes","osTypesDesc","userOSTypesDesc","setUserOSTypesDesc","setSchema","unfilledRichTypes","setUnfilledRichTypes","_selectInputs","_","selectFieldInputs","setSelectFieldInputs","totalSchemaLength","schemaPrevIndex","setSchIndex","richTypePrevIndex","setRichIndex","selectRefs","index","createRef","selectRefsState","json","uTypes","uTypeDesc","fetchTypes","resourceHasRichType","handleRichType","useMemo","columnsSchema","getTableBodyProps","handleChange","key","newSchema","background","newFInputs","undefined","alert","columnValue","textContent","trim","columnType","typeValue","filter","columnTypeOptions","label","renderEditSchemaField","disabled","types","customStyles","menu","provided","borderBottom","color","selectProps","menuColor","singleValue","opacity","isDisabled","transition","styles","options","inputValue","ResourceList","deleteResource","addResourceScreen","title","Metadata","isCheck","val","required","description","image","tags","govt_level","checked","author_website","author_email","pub_institutional_name","continent","region","country","countries","city","periodicity","years_included","start_date","end_date","encoding","encodeData","DatasetEditor","handleRichTypeCount","richTypeFilled","handleChangeMetadata","values","Array","from","Set","currentVals","mapDatasetToFiscalFormat","model","f","fdp","TypeProcessor","fieldsToModel","res","downloadDatapackage","fileDownload","window","confirm","temp_dataset","axios","method","url","metadata","setLoading","isLoading","ui","status","newUiState","nextScreen","prevScreen","setTimeout","onChangeResourceId","resourceId","currentStep","newStep","handleSaveDataset","saveButtonText","config","format","fileOrLink","uploadComplete","isResourceEdit","skipUpload","bind","mapResourceToDatapackageResource","updatedResource","fileResource","dialect","ReactLogo","onSubmit","preventDefault","authToken","savedDataset","defaultProps","authorizedApi","metastoreApi","element","document","getElementById","ReactDOM","StrictMode"],"mappings":"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","file":"static/js/main.95f5af2b.chunk.js","sourcesContent":["var map = {\n\t\"./geojson.json\": 264,\n\t\"./table-schema.json\": 566,\n\t\"./topojson.json\": 265\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 565;","import React, { useEffect, useState, useRef } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport \"./ProgressBar.css\";\r\n\r\nconst ProgressBar = (props) => {\r\n  const [offset, setOffset] = useState(0);\r\n  const circleRef = useRef(null);\r\n  const {\r\n    size,\r\n    progress,\r\n    strokeWidth,\r\n    circleOneStroke,\r\n    circleTwoStroke,\r\n    timeRemaining,\r\n  } = props;\r\n\r\n  const center = size / 2;\r\n  const radius = size / 2 - strokeWidth / 2;\r\n  const circumference = 2 * Math.PI * radius;\r\n\r\n  useEffect(() => {\r\n    const progressOffset = ((100 - progress) / 100) * circumference;\r\n    setOffset(progressOffset);\r\n\r\n    circleRef.current.style = \"transition: stroke-dashoffset 850ms ease-in-out\";\r\n  }, [setOffset, progress, circumference, offset]);\r\n\r\n  return (\r\n    <>\r\n      <svg className=\"svg\" width={size} height={size}>\r\n        <circle\r\n          className=\"svg-circle-bg\"\r\n          stroke={circleOneStroke}\r\n          cx={center}\r\n          cy={center}\r\n          r={radius}\r\n          strokeWidth={strokeWidth}\r\n        />\r\n        <circle\r\n          className=\"svg-circle\"\r\n          ref={circleRef}\r\n          stroke={circleTwoStroke}\r\n          cx={center}\r\n          cy={center}\r\n          r={radius}\r\n          strokeWidth={strokeWidth}\r\n          strokeDasharray={circumference}\r\n          strokeDashoffset={offset}\r\n        />\r\n        <text x={`${center}`} y={`${center + 2}`} className=\"svg-circle-text\">\r\n          {progress}%\r\n        </text>\r\n      </svg>\r\n      {timeRemaining > 0 &&  <span className=\"time-remaining\">{timeRemaining > 60 ? `${Math.floor(timeRemaining /60)} minute${Math.floor(timeRemaining /60) > 1 ? 's' : ''}` : `${Math.floor(timeRemaining)} second${timeRemaining > 1 ? 's' : ''}`} left</span>}\r\n    </>\r\n  );\r\n};\r\n\r\nProgressBar.propTypes = {\r\n  size: PropTypes.number.isRequired,\r\n  progress: PropTypes.number.isRequired,\r\n  strokeWidth: PropTypes.number.isRequired,\r\n  circleOneStroke: PropTypes.string.isRequired,\r\n  circleTwoStroke: PropTypes.string.isRequired,\r\n};\r\n\r\nexport default ProgressBar;\r\n","const onFormatBytes = (bytes, decimals = 1) => {\r\n  if (bytes === 0) return \"0 Bytes\";\r\n\r\n  const k = 1000;\r\n  const dm = decimals < 0 ? 0 : decimals;\r\n  const sizes = [\"Bytes\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\", \"ZB\", \"YB\"];\r\n\r\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n\r\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + \" \" + sizes[i];\r\n};\r\n\r\nconst removeHyphen = (id) => {\r\n  return id.replace(/-/g, \"\");\r\n};\r\n\r\nconst isValidURL = (val) => {\r\n  const res = val.match(\r\n    /(http(s)?:\\/\\/.)?(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_\\+.~#?&//=]*)/g\r\n  );\r\n  return res !== null;\r\n};\r\n\r\nexport { removeHyphen, onFormatBytes, isValidURL };\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport './InputFile.css'\r\nimport upload from \"../../assets/upload.png\"\r\nconst InputFile = ({ onChangeHandler }) => {\r\n\r\n    return (\r\n        <div className=\"upload-area__drop\">\r\n            <input\r\n                className=\"upload-area__drop__input\"\r\n                type=\"file\"\r\n                name=\"file\"\r\n                onChange={onChangeHandler}\r\n            />\r\n            <img\r\n                className=\"upload-area__drop__icon\"\r\n                src={upload}\r\n                alt=\"upload-icon\"\r\n            />\r\n            <span className=\"upload-area__drop__text\">\r\n                Drag and drop your files\r\n                    <br />\r\n                    or <br />\r\n                    click to select\r\n                </span>\r\n        </div>\r\n    )\r\n}\r\n\r\nInputFile.propTypes = {\r\n    onChangeHandler: PropTypes.func.isRequired\r\n};\r\n\r\nexport default InputFile;\r\n","export default \"data:image/png;base64,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\"","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport \"./InputUrl.css\";\r\n\r\nconst InputUrl = ({ onChangeUrl }) => {\r\n  const handleKeyPress = (event) => {\r\n    if (event.keyCode === 13) {\r\n      event.target.blur();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"upload-area__url\">\r\n      <label className=\"upload-area__url__label\" htmlFor=\"input-url\">\r\n        URL:\r\n      </label>\r\n      <input\r\n        className=\"upload-area__url__input\"\r\n        id=\"input-url\"\r\n        type=\"url\"\r\n        name=\"input-url\"\r\n        onBlur={onChangeUrl}\r\n        onKeyDown={(event) => handleKeyPress(event)}\r\n        placeholder=\"https://www.data.com/sample.csv\"\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nInputUrl.propTypes = {\r\n  onChangeUrl: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default InputUrl;\r\n","import React, { useState } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport InputFile from \"../InputFile\";\r\nimport InputUrl from \"../InputUrl\";\r\nimport './Choose.css'\r\n\r\nconst Choose = ({ onChangeUrl, onChangeHandler }) => {\r\n  const [uploadOption, setUploadOption] = useState(false);\r\n\r\n  return (\r\n    <div className=\"upload-choose\">\r\n      {uploadOption ? (\r\n        <>\r\n          {uploadOption === \"file\" && (\r\n            <InputFile onChangeHandler={onChangeHandler} />\r\n          )}\r\n          {uploadOption === \"url\" && <InputUrl onChangeUrl={onChangeUrl} />}\r\n        </>\r\n      ) : (\r\n        <div>\r\n          <button className=\"choose-btn\" onClick={() => setUploadOption(\"file\")}>Choose a file to Upload </button>\r\n          <p className=\"choose-text\">OR</p>\r\n          <button className=\"choose-btn\" onClick={() => setUploadOption(\"url\")}>Link a file already online</button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nChoose.propTypes = {\r\n  onChangeUrl: PropTypes.func.isRequired,\r\n  onChangeHandler: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default Choose;\r\n","import React from \"react\";\r\nimport { Client } from \"giftless-client\";\r\nimport * as data from \"frictionless.js\";\r\nimport ProgressBar from \"../ProgressBar\";\r\nimport { onFormatBytes, isValidURL } from \"../../utils\";\r\nimport Choose from \"../Choose\";\r\nimport toArray from \"stream-to-array\";\r\nimport \"./Upload.css\";\r\nclass Upload extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      datasetId: props.datasetId,\r\n      organizationId: props.organizationId,\r\n      dataset: props.dataset,\r\n      selectedFile: null,\r\n      fileSize: 0,\r\n      formattedSize: \"0 KB\",\r\n      start: \"\",\r\n      loaded: 0,\r\n      success: false,\r\n      error: false,\r\n      fileExists: false,\r\n      loading: false,\r\n      timeRemaining: 0,\r\n      hashInProgress: false,\r\n      hashLoaded: 0,\r\n      uploadInProgress: false,\r\n      uploadedFileType: null,\r\n    };\r\n  }\r\n\r\n  onChangeHandler = async (event) => {\r\n    let { formattedSize, selectedFile } = this.state;\r\n    let path = \"\";\r\n    let storeFile;\r\n    let dataFile, hashCopy;\r\n    if (event.target.type == \"file\" && event.target.files.length > 0) {\r\n      storeFile = event.target.files[0]\r\n      selectedFile = event.target.files[0];\r\n      path = `data/${selectedFile.name}`; //path property in data package resource\r\n      this.setState({ uploadedFileType: \"file\" });\r\n    } else {\r\n      selectedFile = event.target.value;\r\n      if (!isValidURL(selectedFile)) {\r\n        this.setErrorState(\"Invalid URL! Please ensure entered URL is correct\");\r\n        return;\r\n      }\r\n      this.setState({ uploadedFileType: \"url\" });\r\n      path = selectedFile;\r\n    }\r\n\r\n    this.validFileSelected(selectedFile, event.target.type).then(async (resp) => {\r\n      const { validFile, errorMsg, file } = resp\r\n\r\n      if (!validFile) {\r\n        this.setErrorState(errorMsg);\r\n        return;\r\n      }\r\n\r\n      formattedSize = onFormatBytes(file.size || 0);\r\n\r\n      let self = this;\r\n      const hash = await file.hash(\"sha256\", (progress) => {\r\n        self.onHashProgress(progress);\r\n      });\r\n\r\n      Object.assign(file.descriptor, { hash });\r\n\r\n      //check if file has the same schema\r\n      if (!this.hasSameSchema(file._descriptor)) {\r\n        this.setErrorState(\r\n          \"Schema of uploaded resource does not match existing one!\"\r\n        );\r\n        return;\r\n      }\r\n\r\n      //check if file already exists in resource\r\n      if (this.hasSameHash(file._descriptor)) {\r\n        this.setErrorState(\"Possible duplicate, the resource already exists!\");\r\n        return;\r\n      }\r\n\r\n      //get sample\r\n      let sample_stream = await file.rows({ size: 460 });\r\n      let sample = (await toArray(sample_stream)).slice(0, 30);\r\n\r\n      \r\n      if (storeFile) {\r\n        let readfile1 = await storeFile.text()\r\n        let headerLength = readfile1.indexOf(\"\\n\") + 1\r\n\r\n        let removeHeader = storeFile.slice(headerLength,)\r\n        dataFile = new File([removeHeader], selectedFile.name, {\r\n          type: \"text/csv\",\r\n        });\r\n\r\n        let copyFile = data.open(dataFile)\r\n\r\n        hashCopy = await copyFile.hash(\"sha256\", (progress) => {\r\n          self.onHashProgress(progress);\r\n        });\r\n        Object.assign(copyFile.descriptor, { hashCopy });\r\n      }\r\n      \r\n      //get column names for table\r\n      const column_names = sample[0]; //first row is the column names\r\n      const tablePreviewColumns = column_names.map((item) => {\r\n        return {\r\n          Header: item,\r\n          accessor: item,\r\n        };\r\n      });\r\n\r\n      //prepare sample for use in table preview component\r\n      let tablePreviewSample = [];\r\n      sample.slice(1, 11).forEach((item) => {\r\n        let temp_obj = {};\r\n        item.forEach((field, i) => {\r\n          temp_obj[column_names[i]] = field;\r\n        });\r\n        tablePreviewSample.push(temp_obj);\r\n      });\r\n\r\n      if (storeFile) {\r\n        this.props.metadataHandler(\r\n          Object.assign(file.descriptor, {\r\n            sample,\r\n            tablePreviewSample,\r\n            tablePreviewColumns,\r\n            path,\r\n            hashCopy\r\n          })\r\n        );\r\n      } else {\r\n          this.props.metadataHandler(\r\n          Object.assign(file.descriptor, {\r\n            sample,\r\n            tablePreviewSample,\r\n            tablePreviewColumns,\r\n            path,\r\n          })\r\n        );\r\n      }\r\n\r\n      this.setState({\r\n        selectedFile,\r\n        loaded: 0,\r\n        success: false,\r\n        fileExists: false,\r\n        error: false,\r\n        formattedSize,\r\n      });\r\n\r\n      await this.uploadToFileStorageHandler();\r\n\r\n      if (storeFile) {\r\n        await this.uploadToFileCopyStorageHandler(dataFile)\r\n      } else {\r\n        this.props.handleUploadStatus({\r\n          loading: false,\r\n          success: true,\r\n        });\r\n      }\r\n    }).catch((error) => {\r\n      const { errorMsg } = error\r\n      this.setErrorState(errorMsg);\r\n    })\r\n  };\r\n\r\n  validFileSelected = (selectedFile, fileType) => {\r\n    return new Promise(async (resolve, reject) => {\r\n      if (fileType == \"url\") {\r\n        const fileExt = selectedFile.split(\".\").pop();\r\n        if (fileExt != \"csv\") {\r\n          reject({\r\n            validFile: false,\r\n            errorMsg:\r\n              \"File Type not supported! Please ensure specified url links to a CSV file\",\r\n          });\r\n          return;\r\n        }\r\n\r\n        fetch(selectedFile)\r\n          .then(async (resp) => {\r\n            let file;\r\n            try {\r\n              file = data.open(selectedFile);\r\n              await file.addSchema();\r\n              resolve({\r\n                validFile: true,\r\n                errorMsg: \"\",\r\n                file,\r\n              });\r\n            } catch (error) {\r\n              reject({\r\n                validFile: false,\r\n                errorMsg: \"An error occurred when trying to download the file!\",\r\n              });\r\n            }\r\n          })\r\n          .catch((error) => {\r\n            reject({\r\n              validFile: false,\r\n              errorMsg: `An error occured when trying to download the file!\r\n               This can happen because CORS is disabled on the server or if the file does not exist.`,\r\n            });\r\n          });\r\n      } else {\r\n        const fileExt = selectedFile.type.split(\"/\").pop();\r\n        if (fileExt != \"csv\") {\r\n          reject({\r\n            validFile: false,\r\n            errorMsg: \"File Type not supported! Please upload a CSV file\",\r\n          });\r\n          return;\r\n        }\r\n        if (selectedFile.size == 0) {\r\n          reject({\r\n            validFile: false,\r\n            errorMsg:\r\n              \"CSV file is empty! Please upload a CSV file with contents\",\r\n          });\r\n          return;\r\n        }\r\n\r\n        try {\r\n          const file = data.open(selectedFile);\r\n          await file.addSchema();\r\n          resolve({ validFile: true, errorMsg: \"\", file });\r\n        } catch (error) {\r\n          console.log(error);\r\n          reject({\r\n            validFile: false,\r\n            errorMsg: \"An error occurred when trying to load the file!\",\r\n          });\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n  setErrorState(errorMsg) {\r\n    this.setState({ error: true, loading: false });\r\n    this.props.handleUploadStatus({\r\n      loading: false,\r\n      success: false,\r\n      error: true,\r\n      errorMsg,\r\n    });\r\n  }\r\n\r\n  onHashProgress = (progress) => {\r\n    if (progress == 100) {\r\n      this.setState({ hashInProgress: false });\r\n    } else {\r\n      this.setState({ hashLoaded: progress, hashInProgress: true });\r\n    }\r\n  };\r\n\r\n  onUploadProgress = (progressEvent) => {\r\n    const loaded = Number(\r\n      ((progressEvent.loaded / progressEvent.total) * 100).toFixed()\r\n    );\r\n    this.onTimeRemaining(progressEvent.loaded);\r\n    this.setState({\r\n      loaded,\r\n      uploadInProgress: true,\r\n    });\r\n  };\r\n\r\n  onTimeRemaining = (progressLoaded) => {\r\n    const end = new Date().getTime();\r\n    const duration = (end - this.state.start) / 1000;\r\n    const bps = progressLoaded / duration;\r\n    const kbps = bps / 1024;\r\n    const timeRemaining = (this.state.fileSize - progressLoaded) / kbps;\r\n    this.setState({\r\n      timeRemaining: timeRemaining / 1000,\r\n    });\r\n  };\r\n\r\n  hasSameSchema = (resource) => {\r\n    if (\r\n      Object.keys(this.state.dataset).includes(\"resources\") &&\r\n      this.state.dataset.resources.length > 0\r\n    ) {\r\n      const newFields = resource.schema.fields.map((field) => {\r\n        return field.name;\r\n      });\r\n      const oldFields = this.state.dataset.resources[0].schema.fields.map(\r\n        (field) => {\r\n          return field.name;\r\n        }\r\n      );\r\n      return JSON.stringify(newFields) === JSON.stringify(oldFields);\r\n    } else {\r\n      return true;\r\n    }\r\n  };\r\n\r\n  hasSameHash(newResource) {\r\n    if (\r\n      Object.keys(this.state.dataset).includes(\"resources\") &&\r\n      this.state.dataset.resources.length > 0\r\n    ) {\r\n      const { resources } = this.state.dataset;\r\n      const sameHashes = resources.map((resource) => {\r\n        return resource.hash == newResource.hash;\r\n      });\r\n      return sameHashes.includes(true);\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  uploadToFileStorageHandler = async () => {\r\n    const { selectedFile, uploadedFileType } = this.state;\r\n    if (uploadedFileType == \"url\") {\r\n      this.setState({\r\n        success: true,\r\n        loading: false,\r\n        loaded: 100,\r\n      });\r\n\r\n      this.props.handleUploadStatus({\r\n        loading: false,\r\n        success: true,\r\n      });\r\n    } else {\r\n      const start = new Date().getTime();\r\n      const { organizationId, lfsServerUrl } = this.props;\r\n      const client = new Client(lfsServerUrl);\r\n\r\n      const resource = data.open(selectedFile);\r\n      this.setState({\r\n        fileSize: resource.size,\r\n        start,\r\n        loading: true,\r\n      });\r\n\r\n      client\r\n        .upload(\r\n          resource,\r\n          organizationId,\r\n          this.state.datasetId,\r\n          this.onUploadProgress\r\n        )\r\n        .then((response) => {\r\n          this.setState({\r\n            success: true,\r\n            loading: false,\r\n            fileExists: !response,\r\n            loaded: 100,\r\n          });\r\n\r\n          // this.props.handleUploadStatus({\r\n          //   loading: false,\r\n          //   success: true,\r\n          // });\r\n        })\r\n        .catch((error) => {\r\n          console.error(\"Upload failed with error: \" + error);\r\n          this.setState({ error: true, loading: false });\r\n          this.props.handleUploadStatus({\r\n            loading: false,\r\n            success: false,\r\n            error: true,\r\n            errorMsg: `Upload failed with error: ${error.message}`,\r\n          });\r\n        });\r\n    }\r\n  };\r\n\r\n  uploadToFileCopyStorageHandler = async (copySelectedFile) => {\r\n    \r\n    const start = new Date().getTime();\r\n    const { organizationId, lfsServerUrl } = this.props;\r\n    const client = new Client(lfsServerUrl);\r\n\r\n    const resource = data.open(copySelectedFile);\r\n    this.setState({\r\n      fileSize: resource.size,\r\n      start,\r\n      loading: true,\r\n    });\r\n\r\n    client\r\n      .upload(\r\n        resource,\r\n        organizationId,\r\n        \"copy\",\r\n        this.onUploadProgress\r\n      )\r\n      .then((response) => {\r\n        this.setState({\r\n          success: true,\r\n          loading: false,\r\n          fileExists: !response,\r\n          loaded: 100,\r\n        });\r\n\r\n        this.props.handleUploadStatus({\r\n          loading: false,\r\n          success: true,\r\n        });\r\n      })\r\n      .catch((error) => {\r\n        console.error(\"Upload failed with error: \" + error);\r\n        this.setState({ error: true, loading: false });\r\n        this.props.handleUploadStatus({\r\n          loading: false,\r\n          success: false,\r\n          error: true,\r\n          errorMsg: `Upload failed with error: ${error.message}`,\r\n        });\r\n      });\r\n    \r\n  };\r\n\r\n  render() {\r\n    const {\r\n      success,\r\n      fileExists,\r\n      error,\r\n      selectedFile,\r\n      formattedSize,\r\n      hashInProgress,\r\n      uploadInProgress,\r\n      uploadedFileType,\r\n    } = this.state;\r\n    return (\r\n      <div>\r\n        <Choose\r\n          onChangeUrl={this.onChangeHandler}\r\n          onChangeHandler={this.onChangeHandler}\r\n        />\r\n        {uploadedFileType == \"url\" ? (\r\n          <div>\r\n            <p className=\"upload-file-name\">Retrieving file from url...</p>\r\n          </div>\r\n        ) : (\r\n          hashInProgress && (\r\n            <div>\r\n              <>\r\n                <div>\r\n                  <p className=\"upload-file-name\">Computing file hash...</p>\r\n                </div>\r\n                <ProgressBar\r\n                  progress={Math.round(this.state.hashLoaded)}\r\n                  size={100}\r\n                  strokeWidth={5}\r\n                  circleOneStroke=\"#d9edfe\"\r\n                  circleTwoStroke={\"#7ea9e1\"}\r\n                />\r\n              </>\r\n            </div>\r\n          )\r\n        )}\r\n        {uploadInProgress && (\r\n          <div>\r\n            <>\r\n              <div>\r\n                <p className=\"upload-file-name\">\r\n                  Uploading {selectedFile.name}...\r\n                </p>\r\n                <p className=\"upload-file-name\">Size: {formattedSize}</p>\r\n              </div>\r\n              <ProgressBar\r\n                progress={this.state.loaded}\r\n                size={100}\r\n                strokeWidth={5}\r\n                circleOneStroke=\"#d9edfe\"\r\n                circleTwoStroke={\"#7ea9e1\"}\r\n              // timeRemaining={timeRemaining}\r\n              />\r\n              <h2>\r\n                {success &&\r\n                  !fileExists &&\r\n                  !error &&\r\n                  \"File uploaded successfully\"}\r\n                {error && \"Upload failed\"}\r\n              </h2>\r\n            </>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Upload;\r\n","import React from \"react\";\r\nimport { useTable } from \"react-table\";\r\nimport MaUTable from \"@material-ui/core/Table\";\r\nimport TableBody from \"@material-ui/core/TableBody\";\r\nimport TableCell from \"@material-ui/core/TableCell\";\r\nimport TableHead from \"@material-ui/core/TableHead\";\r\nimport TableRow from \"@material-ui/core/TableRow\";\r\n\r\n\r\nconst TablePreview = ({ columns, data }) => {\r\n  const { getTableProps, headerGroups, rows, prepareRow } = useTable({\r\n    columns,\r\n    data: data.slice(0, 5),\r\n  });\r\n\r\n  return (\r\n    <div className=\"overflow-x-auto\">\r\n      <MaUTable {...getTableProps()}>\r\n            <TableHead>\r\n              {headerGroups.map((headerGroup) => (\r\n                <TableRow {...headerGroup.getHeaderGroupProps()}>\r\n                  {headerGroup.headers.map((column) => (\r\n                    <TableCell {...column.getHeaderProps()}>\r\n                      {column.render(\"Header\")}\r\n                    </TableCell>\r\n                  ))}\r\n                </TableRow>\r\n              ))}\r\n            </TableHead>\r\n            <TableBody>\r\n              {rows.map((row, i) => {\r\n                prepareRow(row);\r\n                return (\r\n                  <TableRow {...row.getRowProps()}>\r\n                    {row.cells.map((cell) => {\r\n                      return (\r\n                        <TableCell {...cell.getCellProps()}>\r\n                          {cell.render(\"Cell\")}\r\n                        </TableCell>\r\n                      );\r\n                    })}\r\n                  </TableRow>\r\n                );\r\n              })}\r\n            </TableBody>\r\n      </MaUTable>\r\n    </div>\r\n  );\r\n};\r\n\r\n\r\nexport default TablePreview;","import React, { useState, useEffect, useRef } from \"react\";\r\nimport Select from \"react-select\";\r\nimport PropTypes from \"prop-types\";\r\nimport { useTable } from \"react-table\";\r\nimport types from \"../../db/types.json\";\r\nimport osTypes from \"../../db/os-types.json\";\r\nimport osTypesDesc from \"../../db/os-type-descriptions.json\";\r\nimport \"./TableSchema.css\";\r\n\r\nconst osTypesPath =\r\n  \"https://raw.githubusercontent.com/gift-data/gift-os-types/main/os-types.json\";\r\nconst osTypesDescPath =\r\n  \"https://raw.githubusercontent.com/gift-data/gift-os-types/main/os-type-descriptions.json\";\r\n\r\n\r\nconst TableSchema = (props) => {\r\n  const [userOSTypes, setUserOSTypes] = useState(osTypes); //set default value to local types in case of fetch issue\r\n  const [userOSTypesDesc, setUserOSTypesDesc] = useState(osTypesDesc);\r\n  const [schema, setSchema] = useState(props.schema);\r\n  const [unfilledRichTypes, setUnfilledRichTypes] = useState(\r\n    props.schema.fields.length\r\n  );\r\n  const _selectInputs = props.schema.fields.map((_) => undefined)\r\n  const [selectFieldInputs, setSelectFieldInputs] = useState(_selectInputs);\r\n  const totalSchemaLength = props.schema.fields.length;\r\n  const [schemaPrevIndex, setSchIndex] = useState(null);\r\n  const [richTypePrevIndex, setRichIndex] = useState(null);\r\n\r\n  //Refs used in updated select field style. \r\n  // This is used to notify the user which rich type has incorrect value.\r\n  let selectRefs = useRef([]);\r\n  selectRefs = props.schema.fields.map(\r\n    (_, index) => selectRefs.current[index] = React.createRef()\r\n  )\r\n  const [selectRefsState, _] = useState(selectRefs);\r\n\r\n  useEffect(() => {\r\n    async function fetchTypes() {\r\n      let uTypes = await (await fetch(osTypesPath)).json();\r\n      let uTypeDesc = await (await fetch(osTypesDescPath)).json();\r\n      setUserOSTypes(uTypes);\r\n      setUserOSTypesDesc(uTypeDesc);\r\n    }\r\n    fetchTypes();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (\r\n      props.dataset.resources &&\r\n      props.dataset.resources.length > 1 &&\r\n      resourceHasRichType(props.dataset)\r\n    ) {\r\n      props.handleRichType(0);\r\n    }\r\n  }, []);\r\n\r\n  const data = React.useMemo(() => [...props.data], [schema]);\r\n\r\n  const columnsSchema = schema.fields.map((item, index) => {\r\n    return {\r\n      Header: item.name ? item.name : `column_${index + 1}`,\r\n      accessor: item.name ? item.name : `column_${index + 1}`,\r\n    };\r\n  });\r\n\r\n  const columns = React.useMemo(() => [...columnsSchema], [schema]);\r\n\r\n  const {\r\n    getTableProps,\r\n    getTableBodyProps,\r\n    headerGroups,\r\n    rows,\r\n    prepareRow,\r\n  } = useTable({ columns, data });\r\n\r\n  const handleChange = (event, key, index) => {\r\n    const value = event.value\r\n    const newSchema = { ...schema };\r\n    if (key == \"columnType\") {\r\n      const type = newSchema.fields[index][\"type\"]\r\n      const selectedRichType = userOSTypes[value]['dataType']\r\n      if (type == selectedRichType) { //do richtype validation here\r\n        selectRefsState[index].current.style.background = \"white\";\r\n        const value = event.value\r\n\r\n        newSchema.fields[index][key] = value;\r\n        setSchema(newSchema);\r\n        setUnfilledRichTypes(unfilledRichTypes - 1);\r\n        props.handleRichType(unfilledRichTypes - 1);\r\n\r\n      } else {\r\n        const newFInputs = [...selectFieldInputs,]\r\n        newFInputs[index] = undefined\r\n        setSelectFieldInputs(newFInputs)\r\n        selectRefsState[index].current.style.background = \"red\";\r\n        \r\n        if (unfilledRichTypes < totalSchemaLength && index != richTypePrevIndex) {\r\n          setUnfilledRichTypes(unfilledRichTypes + 1);\r\n          props.handleRichType(unfilledRichTypes + 1);\r\n          setRichIndex(index)\r\n        }\r\n        alert(`Invalid richtype for type ${type}`)\r\n      }\r\n\r\n    } else {\r\n      let columnValue = selectRefsState[index].current.textContent.split('➜')[0].trim()\r\n      columnValue = columnValue === \"Select...\" ? undefined : columnValue\r\n      const columnType = columnValue ? userOSTypes[columnValue]['dataType'] : undefined\r\n      const typeValue = event.target.value\r\n      if (columnValue) {\r\n        if (columnType != typeValue) {\r\n          const newFInputs = [...selectFieldInputs,]\r\n          newFInputs[index] = undefined\r\n          setSelectFieldInputs(newFInputs)\r\n          selectRefsState[index].current.style.background = \"red\";\r\n          \r\n          if (unfilledRichTypes < totalSchemaLength && index != schemaPrevIndex) {\r\n            setUnfilledRichTypes(unfilledRichTypes + 1);\r\n            props.handleRichType(unfilledRichTypes + 1);\r\n            setSchIndex(index)\r\n          }\r\n          newSchema.fields[index][key] = typeValue;\r\n          setSchema(newSchema);\r\n          alert(`Invalid richtype for type ${typeValue}`)\r\n        } else {\r\n          selectRefsState[index].current.style.background = \"white\";\r\n          newSchema.fields[index][key] = typeValue;\r\n          setSchema(newSchema);\r\n          setUnfilledRichTypes(unfilledRichTypes - 1);\r\n          props.handleRichType(unfilledRichTypes - 1);\r\n        }\r\n        \r\n      } else {\r\n        newSchema.fields[index][key] = event.target.value;\r\n        setSchema(newSchema);\r\n      }\r\n      \r\n    }\r\n  }\r\n\r\n  const resourceHasRichType = (dataset) => {\r\n    if (\r\n      Object.keys(dataset).includes(\"resources\") &&\r\n      dataset.resources.length > 0\r\n    ) {\r\n      const fields = dataset.resources[0].schema.fields;\r\n      const columnTypes = fields.filter((field) => {\r\n        return Object.keys(field).includes(\"columnType\");\r\n      });\r\n\r\n      const hasRichTypes = columnTypes.length == fields.length ? true : false;\r\n      return hasRichTypes;\r\n    }\r\n  };\r\n\r\n  //if the the user upload a new file, will update the state\r\n  //and render with the new values\r\n  useEffect(() => {\r\n    setSchema(props.schema);\r\n  }, [props.schema]);\r\n\r\n  //set column types search input box\r\n  let ctypeKeys = Object.keys(userOSTypes);\r\n  const columnTypeOptions = ctypeKeys.map((key) => {\r\n    let desc;\r\n    let label;\r\n    let value = key;\r\n    if (userOSTypesDesc[key]) {\r\n      desc = userOSTypesDesc[key][\"description\"];\r\n      label = value + \" \" + \"➜\" + \" \" + desc;\r\n    } else {\r\n      desc = \"\";\r\n      label = value;\r\n    }\r\n\r\n    return { label, value };\r\n  });\r\n\r\n  const renderEditSchemaField = (key) => {\r\n    if (key === \"type\") {\r\n      if (\r\n        props.dataset.resources &&\r\n        props.dataset.resources.length > 1 &&\r\n        resourceHasRichType(props.dataset)\r\n      ) {\r\n        const existingTypes = props.dataset.resources[0].schema.fields.map(\r\n          (field) => {\r\n            return field.type;\r\n          }\r\n        );\r\n        //The schema already exists. Prefill and set to uneditable\r\n        return existingTypes.map((item, index) => (\r\n          <td key={`schema-type-field-${key}-${index}`}>\r\n            <input\r\n              className=\"table-tbody-input\"\r\n              type=\"text\"\r\n              value={item}\r\n              disabled\r\n            />\r\n          </td>\r\n        ));\r\n      } else {\r\n        return schema.fields.map((item, index) => (\r\n          <td key={`schema-type-field-${key}-${index}`}>\r\n            <select\r\n              className=\"table-tbody-select\"\r\n              value={item[key] || \"\"}\r\n              onChange={(event) => handleChange(event, key, index)}\r\n            >\r\n              {types.type.map((item, index) => {\r\n                return (\r\n                  <option\r\n                    key={`schema-type-field-option-${item}-${index}`}\r\n                    value={item}\r\n                  >\r\n                    {item}\r\n                  </option>\r\n                );\r\n              })}\r\n            </select>\r\n          </td>\r\n        ));\r\n      }\r\n    }\r\n    //style for column rich type select field\r\n    const customStyles = {\r\n      menu: (provided, state) => ({\r\n        ...provided,\r\n        borderBottom: \"1px dotted pink\",\r\n        color: state.selectProps.menuColor,\r\n      }),\r\n      singleValue: (provided, state) => {\r\n        const opacity = state.isDisabled ? 0.5 : 1;\r\n        const transition = \"opacity 300ms\";\r\n        return { ...provided, opacity, transition };\r\n      },\r\n    };\r\n\r\n    if (key === \"columnType\") {\r\n      if (\r\n        props.dataset.resources &&\r\n        props.dataset.resources.length > 1 &&\r\n        resourceHasRichType(props.dataset)\r\n      ) {\r\n        const existingRichTypes = props.dataset.resources[0].schema.fields.map(\r\n          (field) => {\r\n            return field.columnType;\r\n          }\r\n        );\r\n        //The schema already exists, and we assume columns have the same richTypes. Prefill and set to uneditable\r\n        return existingRichTypes.map((item, index) => (\r\n          <td key={`schema-type-field-${key}-${index}`}>\r\n            <input\r\n              className=\"table-tbody-input\"\r\n              type=\"text\"\r\n              value={item}\r\n              disabled\r\n            />\r\n          </td>\r\n        ));\r\n      } else {\r\n        return schema.fields.map((item, index) => (\r\n          <td key={`schema-type-field-${key}-${index}`}\r\n            ref={selectRefsState[index]}\r\n          >\r\n            <Select\r\n              key={`select#${index}`}\r\n              styles={customStyles}\r\n              options={columnTypeOptions}\r\n              value={selectFieldInputs[index]}\r\n              inputValue={selectFieldInputs[index]}\r\n              menuColor=\"black\"\r\n              onChange={(event) => {\r\n                handleChange(event, key, index)\r\n              }}\r\n            />\r\n          </td>\r\n        ));\r\n      }\r\n    }\r\n\r\n    return schema.fields.map((item, index) => (\r\n      <td key={`schema-field-${key}-${index}`}>\r\n        <input\r\n          className=\"table-tbody-input\"\r\n          type=\"text\"\r\n          value={item[key]}\r\n          onChange={(event) => handleChange(event, key, index)}\r\n        />\r\n      </td>\r\n    ));\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"table-container\">\r\n        <table className=\"table-schema-help\">\r\n          <tbody>\r\n            <tr className=\"table-tbody-help-tr\">\r\n              <td className=\"table-tbody-help-td-empty\"></td>\r\n            </tr>\r\n            <tr className=\"table-tbody-help-tr\">\r\n              <td className=\"table-tbody-help-td\">Title</td>\r\n            </tr>\r\n            <tr className=\"table-tbody-help-tr\">\r\n              <td className=\"table-tbody-help-td\">Description</td>\r\n            </tr>\r\n            <tr className=\"table-tbody-help-tr\">\r\n              <td className=\"table-tbody-help-td\">Type</td>\r\n            </tr>\r\n            <tr className=\"table-tbody-help-tr\">\r\n              <td className=\"table-tbody-help-td\">Format</td>\r\n            </tr>\r\n            <tr className=\"table-tbody-help-tr\">\r\n              <td className=\"table-tbody-help-td\">Rich Type</td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n        <div className=\"table-schema-info_container\">\r\n          <table className=\"table-schema-info_table\" {...getTableProps()}>\r\n            <thead>\r\n              {headerGroups.map((headerGroup) => (\r\n                <tr\r\n                  className=\"table-thead-tr\"\r\n                  {...headerGroup.getHeaderGroupProps()}\r\n                >\r\n                  {headerGroup.headers.map((column) => (\r\n                    <th className=\"table-thead-th\" {...column.getHeaderProps()}>\r\n                      {column.render(\"Header\")}\r\n                    </th>\r\n                  ))}\r\n                </tr>\r\n              ))}\r\n            </thead>\r\n            <tbody {...getTableBodyProps()}>\r\n              <tr className=\"table-tbody-tr-help\">\r\n                {renderEditSchemaField(\"title\")}\r\n              </tr>\r\n              <tr className=\"table-tbody-tr-help\">\r\n                {renderEditSchemaField(\"description\")}\r\n              </tr>\r\n              <tr>{renderEditSchemaField(\"type\")}</tr>\r\n              <tr>{renderEditSchemaField(\"format\")}</tr>\r\n              <tr>{renderEditSchemaField(\"columnType\")}</tr>\r\n              <br />\r\n              {rows.map((row) => {\r\n                prepareRow(row);\r\n                return (\r\n                  <tr {...row.getRowProps()}>\r\n                    {row.cells.map((cell) => {\r\n                      return (\r\n                        <td {...cell.getCellProps()} className=\"table-tbody-td\">\r\n                          {cell.render(\"Cell\")}\r\n                        </td>\r\n                      );\r\n                    })}\r\n                  </tr>\r\n                );\r\n              })}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nTableSchema.propTypes = {\r\n  schema: PropTypes.object.isRequired,\r\n  data: PropTypes.array.isRequired,\r\n  handleRichType: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default TableSchema;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\n\r\nconst ResourceList = ({ dataset, deleteResource, addResourceScreen }) => {\r\n  const hasResources = Object.keys(dataset).includes(\"resources\")\r\n  if (!hasResources) {\r\n    return (\r\n      <div>\r\n        <div>\r\n          <h1>No Resource Available</h1>\r\n        </div>\r\n        <div className=\"resource-edit-actions\">\r\n          <button className=\"btn\" onClick={() => { addResourceScreen() }}>\r\n            Add Resource\r\n          </button>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n  const resources = [...dataset.resources]\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"justify-center\">\r\n        <div>\r\n          <h1>\r\n            Available Resources in Dataset\r\n          </h1>\r\n          <table className=\"min-w-full divide-y divide-gray-200\">\r\n            <tbody className=\"bg-white divide-y divide-gray-200\">\r\n              {resources.map((resource, i) => {\r\n                return (\r\n                  <tr key={`${i}-index`}>\r\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                      <div className=\"flex items-center\">\r\n                        <div className=\"ml-4\">\r\n                          <div className=\"text-sm font-medium text-gray-900\">\r\n                            {resource.title || resource.name} \r\n                          </div>\r\n\r\n                        </div>\r\n                      </div>\r\n                    </td>\r\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                      <div className=\"flex items-center\">\r\n                        <div className=\"ml-4\">\r\n                          <button id={`rmBtn${i}`}\r\n                            type=\"button\"\r\n                            className=\"btn-delete\"\r\n                            onClick={() => { deleteResource(resource.hash) }}>Remove</button>\r\n                        </div>\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                );\r\n              })}\r\n            </tbody>\r\n          </table>\r\n          <div className=\"resource-edit-actions\">\r\n            <button className=\"btn\" onClick={() => { addResourceScreen() }}>\r\n              Add Resource\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nResourceList.propTypes = {\r\n  dataset: PropTypes.object.isRequired,\r\n  deleteResource: PropTypes.func.isRequired,\r\n  addResourceScreen: PropTypes.func.isRequired\r\n};\r\n\r\nexport default ResourceList;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { encodeData } from \"datapub\";\r\nimport countries from \"../../db/countries.json\";\r\nimport \"./Metadata.css\";\r\n\r\nconst Metadata = ({ dataset, handleChange }) => {\r\n  const isCheck = (val, field) => {\r\n    return dataset[field] && dataset[field].includes(val);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <h3 className=\"metadata-section-title\">\r\n        Mandatory fields are marked with an asterisk (\r\n        <span className=\"ast-important\">*</span>).\r\n      </h3>\r\n      <h1 className=\"metadata-section-title\">\r\n        <b>General</b>\r\n      </h1>\r\n      <div className=\"metadata-input\">\r\n        <input\r\n          className=\"metadata-input__input\"\r\n          type=\"text\"\r\n          name=\"title\"\r\n          id=\"title\"\r\n          placeholder=\"example_file.csv\"\r\n          value={dataset.title}\r\n          required\r\n          onChange={(e) => {\r\n            handleChange(e);\r\n          }}\r\n        />\r\n        <label className=\"metadata-label\" htmlFor=\"title\">\r\n          <span className=\"ast-important\">*</span> Title of the dataset\r\n        </label>\r\n      </div>\r\n\r\n      <div className=\"metadata-input\">\r\n        <textarea\r\n          className=\"metadata-input__textarea\"\r\n          type=\"text\"\r\n          name=\"description\"\r\n          id=\"description\"\r\n          placeholder=\"Enter a description for your dataset\"\r\n          value={dataset.description || \"\"}\r\n          onChange={(e) => {\r\n            handleChange(e);\r\n          }}\r\n          rows={5}\r\n          required\r\n        ></textarea>\r\n        <label className=\"metadata-label\" htmlFor=\"description\">\r\n          <span className=\"ast-important\">*</span> Description of the dataset\r\n        </label>\r\n      </div>\r\n      <div className=\"metadata-input\">\r\n        <input\r\n          className=\"metadata-input__input\"\r\n          type=\"url\"\r\n          name=\"image\"\r\n          id=\"image\"\r\n          placeholder=\"https://mylogo.png\"\r\n          value={dataset.image}\r\n          onChange={(e) => {\r\n            handleChange(e);\r\n          }}\r\n        />\r\n        <label className=\"metadata-label\" htmlFor=\"title\">\r\n          Logo Url\r\n        </label>\r\n      </div>\r\n      <div className=\"metadata-input\">\r\n        <textarea\r\n          type=\"text\"\r\n          name=\"tags\"\r\n          id=\"tags\"\r\n          className=\"metadata-input-textarea\"\r\n          placeholder=\"Finance, Budget\"\r\n          required\r\n          value={dataset.tags || \"\"}\r\n          onChange={(e) => {\r\n            handleChange(e);\r\n          }}\r\n          rows={2}\r\n        ></textarea>\r\n        <div className=\"tooltip\">\r\n          <span className=\"tooltiptext\">\r\n            Only letters are allowed: tags are single words separated by a comma\r\n          </span>\r\n          <label className=\"metadata-label\" htmlFor=\"tags\">\r\n            <span className=\"ast-important\">*</span>\r\n            Tags\r\n          </label>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"metadata-form-grp3\">\r\n        <div className=\"metadata-input\">\r\n          <select\r\n            className=\"metadata-input__input\"\r\n            name=\"govt_level\"\r\n            id=\"govt_level\"\r\n            value={dataset.govt_level || \"\"}\r\n            onChange={(e) => {\r\n              handleChange(e);\r\n            }}\r\n            required\r\n          >\r\n            <option value=\"\">Select</option>\r\n            <option value=\"Municipal\">Municipal</option>\r\n            <option value=\"National\">National</option>\r\n            <option value=\"Provincial\">Provincial</option>\r\n            <option value=\"Regional\">Regional</option>\r\n            <option value=\"State-level\">State-level</option>\r\n          </select>\r\n          <label className=\"metadata-label\" htmlFor=\"govt_level\">\r\n            <span className=\"ast-important\">*</span> Level of government\r\n          </label>\r\n        </div>\r\n        <div>\r\n          <div className=\"metadata-input__input\">\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={isCheck(\"State own enterprises\", \"disaggregation\")}\r\n              id=\"dgg_state\"\r\n              name=\"disaggregation\"\r\n              value=\"State own enterprises\"\r\n              onChange={(e) => {\r\n                handleChange(e);\r\n              }}\r\n            />\r\n            <label htmlFor=\"dgg_state\"> State own enterprises</label>\r\n          </div>\r\n          <div className=\"metadata-input__input\">\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={isCheck(\"Public investments\", \"disaggregation\")}\r\n              id=\"dgg_pub_inv\"\r\n              name=\"disaggregation\"\r\n              value=\"Public investments\"\r\n              onChange={(e) => {\r\n                handleChange(e);\r\n              }}\r\n            />\r\n            <label htmlFor=\"dgg_pub_inv\"> Public investments</label>\r\n          </div>\r\n          <div className=\"metadata-input__input\">\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={isCheck(\"Public programs\", \"disaggregation\")}\r\n              id=\"dgg_pub_prog\"\r\n              name=\"disaggregation\"\r\n              value=\"Public programs\"\r\n              onChange={(e) => {\r\n                handleChange(e);\r\n              }}\r\n            />\r\n            <label htmlFor=\"dgg_pub_prog\"> Public programs</label>\r\n          </div>\r\n          <div className=\"metadata-input__input\">\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={isCheck(\"Line item\", \"disaggregation\")}\r\n              id=\"dgg_line\"\r\n              name=\"disaggregation\"\r\n              value=\"Line item\"\r\n              onChange={(e) => {\r\n                handleChange(e);\r\n              }}\r\n            />\r\n            <label htmlFor=\"dgg_line\"> Line item</label>\r\n          </div>\r\n          <label className=\"metadata-label-checkbox\">Disaggregation</label>\r\n        </div>\r\n\r\n        <div>\r\n          <div className=\"metadata-input__input\">\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={isCheck(\"Quarterly Reports\", \"budget_stage\")}\r\n              id=\"budget_qt\"\r\n              name=\"budget_stage\"\r\n              value=\"Quarterly Reports\"\r\n              onChange={(e) => {\r\n                handleChange(e);\r\n              }}\r\n            />\r\n            <label htmlFor=\"budget_qt\"> Quarterly Reports</label>\r\n          </div>\r\n          <div className=\"metadata-input__input\">\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={isCheck(\"Year-end\", \"budget_stage\")}\r\n              id=\"budget_yr\"\r\n              name=\"budget_stage\"\r\n              value=\"Year-end\"\r\n              onChange={(e) => {\r\n                handleChange(e);\r\n              }}\r\n            />\r\n            <label htmlFor=\"budget_yr\"> Year-end</label>\r\n          </div>\r\n          <div className=\"metadata-input__input\">\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={isCheck(\"Proposed\", \"budget_stage\")}\r\n              id=\"budget_prop\"\r\n              name=\"budget_stage\"\r\n              value=\"Proposed\"\r\n              onChange={(e) => {\r\n                handleChange(e);\r\n              }}\r\n            />\r\n            <label htmlFor=\"budget_prop\"> Proposed</label>\r\n          </div>\r\n          <div className=\"metadata-input__input\">\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={isCheck(\"Enacted\", \"budget_stage\")}\r\n              id=\"budget_st\"\r\n              name=\"budget_stage\"\r\n              value=\"Enacted\"\r\n              onChange={(e) => {\r\n                handleChange(e);\r\n              }}\r\n            />\r\n            <label htmlFor=\"budget_st\"> Enacted</label>\r\n          </div>\r\n          <label className=\"metadata-label-checkbox\">Budget Stage</label>\r\n        </div>\r\n      </div>\r\n\r\n      <h1 className=\"metadata-section-title\">\r\n        <b>Owner</b>\r\n      </h1>\r\n      <div className=\"metadata-form\">\r\n        <div className=\"metadata-input\">\r\n          <input\r\n            className=\"metadata-input__input\"\r\n            type=\"url\"\r\n            name=\"author_website\"\r\n            id=\"author_website\"\r\n            value={dataset.author_website}\r\n            onChange={(e) => {\r\n              handleChange(e);\r\n            }}\r\n          />\r\n          <label className=\"metadata-label\" htmlFor=\"author_website\">\r\n            Author's Website\r\n          </label>\r\n        </div>\r\n        <div className=\"metadata-input\">\r\n          <input\r\n            className=\"metadata-input__input\"\r\n            type=\"email\"\r\n            name=\"author_email\"\r\n            id=\"author_email\"\r\n            value={dataset.author_email}\r\n            onChange={(e) => {\r\n              handleChange(e);\r\n            }}\r\n          />\r\n          <label className=\"metadata-label\" htmlFor=\"author_email\">\r\n            Author's Email Address\r\n          </label>\r\n        </div>\r\n      </div>\r\n      <div className=\"metadata-input\">\r\n        <input\r\n          className=\"metadata-input__input\"\r\n          type=\"text\"\r\n          name=\"pub_institutional_name\"\r\n          id=\"pub_institutional_name\"\r\n          value={dataset.pub_institutional_name}\r\n          onChange={(e) => {\r\n            handleChange(e);\r\n          }}\r\n          required\r\n        />\r\n        <label className=\"metadata-label\" htmlFor=\"pub_institutional_name\">\r\n          <span className=\"ast-important\">*</span> Publishers' institutional\r\n          name\r\n        </label>\r\n      </div>\r\n      <br />\r\n\r\n      <h1 className=\"metadata-section-title\">\r\n        <b>Location</b>\r\n      </h1>\r\n\r\n      <div className=\"metadata-form\">\r\n        <div className=\"metadata-input\">\r\n          <select\r\n            className=\"metadata-input__input\"\r\n            name=\"continent\"\r\n            id=\"continent\"\r\n            value={dataset.continent || \"\"}\r\n            onChange={(e) => {\r\n              handleChange(e);\r\n            }}\r\n            required\r\n          >\r\n            <option value=\"\">Select</option>\r\n            <option value=\"Europe\">Europe</option>\r\n            <option value=\"Africa\">Africa</option>\r\n            <option value=\"Asia\">Asia</option>\r\n            <option value=\"North America\">North America</option>\r\n            <option value=\"South America\">South America</option>\r\n            <option value=\"Australia\">Australia</option>\r\n          </select>\r\n          <label className=\"metadata-label\" htmlFor=\"continent\">\r\n            Continent\r\n          </label>\r\n        </div>\r\n        <div className=\"metadata-input\">\r\n          <input\r\n            className=\"metadata-input__input\"\r\n            type=\"text\"\r\n            name=\"region\"\r\n            id=\"region\"\r\n            value={dataset.region}\r\n            onChange={(e) => {\r\n              handleChange(e);\r\n            }}\r\n          />\r\n          <label className=\"metadata-label\" htmlFor=\"region\">\r\n            Region\r\n          </label>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"metadata-form\">\r\n        <div className=\"metadata-input\">\r\n          <select\r\n            className=\"metadata-input__input\"\r\n            name=\"country\"\r\n            id=\"country\"\r\n            value={dataset.country || \"\"}\r\n            onChange={(e) => {\r\n              handleChange(e);\r\n            }}\r\n          >\r\n            <option value=\"\">Select</option>\r\n            {countries.map((item) => (\r\n              <option key={`format-${item.text}`} value={item.text}>\r\n                {item.text}\r\n              </option>\r\n            ))}\r\n          </select>\r\n          <label className=\"metadata-label\" htmlFor=\"encoding\">\r\n            Country\r\n          </label>\r\n        </div>\r\n        <div className=\"metadata-input\">\r\n          <input\r\n            className=\"metadata-input__input\"\r\n            type=\"text\"\r\n            name=\"city\"\r\n            id=\"city\"\r\n            value={dataset.city}\r\n            onChange={(e) => {\r\n              handleChange(e);\r\n            }}\r\n          />\r\n          <label className=\"metadata-label\" htmlFor=\"city\">\r\n            City\r\n          </label>\r\n        </div>\r\n      </div>\r\n      <h1 className=\"metadata-section-title\">\r\n        <b>Time</b>\r\n      </h1>\r\n      <div className=\"metadata-form\">\r\n        <div className=\"metadata-input\">\r\n          <select\r\n            className=\"metadata-input__input\"\r\n            name=\"periodicity\"\r\n            id=\"periodicity\"\r\n            value={dataset.periodicity || \"\"}\r\n            onChange={(e) => {\r\n              handleChange(e);\r\n            }}\r\n            required\r\n          >\r\n            <option value=\"\">Select</option>\r\n            <option value=\"Yearly\">Yearly</option>\r\n            <option value=\"Biannual\">Biannual</option>\r\n            <option value=\"Quarterly\">Quarterly</option>\r\n            <option value=\"Monthly\">Monthly</option>\r\n            <option value=\"Daily\">Daily</option>\r\n          </select>\r\n          <label className=\"metadata-label\" htmlFor=\"periodicity\">\r\n            <span className=\"ast-important\">*</span> Periodicity\r\n          </label>\r\n        </div>\r\n        <div className=\"metadata-input\">\r\n          <textarea\r\n            className=\"metadata-input__textarea\"\r\n            type=\"text\"\r\n            name=\"years_included\"\r\n            id=\"years_included\"\r\n            placeholder=\"2015, 2016, 2017, 2005\"\r\n            value={dataset.years_included || \"\"}\r\n            onChange={(e) => {\r\n              handleChange(e);\r\n            }}\r\n            rows={1}\r\n          ></textarea>\r\n          <label className=\"metadata-label\" htmlFor=\"years_included\">\r\n            {\" \"}\r\n            Years included\r\n          </label>\r\n        </div>\r\n      </div>\r\n\r\n      <h1 className=\"metadata-section-title\">\r\n        <b>Fiscal Period</b>\r\n      </h1>\r\n      <div className=\"metadata-form\">\r\n        <div className=\"metadata-input\">\r\n          <input\r\n            className=\"metadata-input__input\"\r\n            type=\"date\"\r\n            name=\"start_date\"\r\n            id=\"start_date\"\r\n            value={dataset.start_date}\r\n            required\r\n            onChange={(e) => {\r\n              handleChange(e);\r\n            }}\r\n          />\r\n          <label className=\"metadata-label\" htmlFor=\"start_date\">\r\n            <span className=\"ast-important\">*</span> Starting date\r\n            (month-day-year)\r\n          </label>\r\n        </div>\r\n        <div className=\"metadata-input\">\r\n          <input\r\n            className=\"metadata-input__input\"\r\n            type=\"date\"\r\n            name=\"end_date\"\r\n            id=\"end_date\"\r\n            value={dataset.end_date}\r\n            required\r\n            onChange={(e) => {\r\n              handleChange(e);\r\n            }}\r\n          />\r\n          <label className=\"metadata-label\" htmlFor=\"end_date\">\r\n            <span className=\"ast-important\">*</span> Ending date\r\n            (month-day-year)\r\n          </label>\r\n        </div>\r\n      </div>\r\n      <h1 className=\"metadata-section-title\">\r\n        <b>Encoding and file format</b>\r\n      </h1>\r\n      <div className=\"metadata-form\">\r\n        <div className=\"metadata-input\">\r\n          <select\r\n            className=\"metadata-input__input\"\r\n            name=\"encoding\"\r\n            id=\"encoding\"\r\n            value={dataset.encoding || \"\"}\r\n            onChange={(e) => {\r\n              handleChange(e);\r\n            }}\r\n            required\r\n          >\r\n            <option value=\"utf_8\">UTF-8</option>\r\n            {encodeData.map((item) => (\r\n              <option key={`format-${item.value}`} value={item.value}>\r\n                {item.label}\r\n              </option>\r\n            ))}\r\n          </select>\r\n          <label className=\"metadata-label\" htmlFor=\"encoding\">\r\n            <span className=\"ast-important\">*</span> File encoding: If you are\r\n            unsure about this setting, please use UTF-8\r\n          </label>\r\n        </div>\r\n        <div className=\"metadata-input\">\r\n          <select className=\"metadata-input__input\" name=\"format\" id=\"format\">\r\n            <option value=\"csv\">CSV</option>\r\n          </select>\r\n          <label className=\"metadata-label\" htmlFor=\"format\">\r\n            File format\r\n          </label>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nMetadata.propTypes = {\r\n  dataset: PropTypes.object.isRequired,\r\n  handleChange: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default Metadata;\r\n","export default __webpack_public_path__ + \"static/media/progressBar.dc3f9f93.svg\";","import React from \"react\";\r\nimport axios from \"axios\";\r\nimport TypeProcessor from \"os-types/src/index\";\r\nimport fileDownload from \"js-file-download\";\r\nimport PropTypes from \"prop-types\";\r\nimport Upload from \"./components/Upload\";\r\nimport TablePreview from \"./components/TablePreview\";\r\nimport TableSchema from \"./components/TableSchema\";\r\nimport ResourceList from \"./components/ResourceList\";\r\nimport Metadata from \"./components/Metadata\";\r\nimport \"./App.css\";\r\nimport ReactLogo from \"./progressBar.svg\";\r\n\r\nexport class DatasetEditor extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    const dataset = props.config.dataset;\r\n    dataset.encoding = \"utf_8\";\r\n    dataset.format = \"csv\";\r\n\r\n    this.state = {\r\n      dataset,\r\n      resource: {}, //This will hold the uploaded resource metadata\r\n      datasetId: dataset.id,\r\n      ui: {\r\n        fileOrLink: \"\",\r\n        uploadComplete: false,\r\n        success: false,\r\n        error: false,\r\n        loading: false,\r\n        errorMsg: \"\",\r\n      },\r\n      client: null,\r\n      isResourceEdit: false,\r\n      currentStep: props.config.skipUpload ? 4 : 0,\r\n      richTypeFilled: false,\r\n      saveButtonText: \"Save\",\r\n    };\r\n    this.metadataHandler = this.metadataHandler.bind(this);\r\n    this.handleRichTypeCount = this.handleRichTypeCount.bind(this);\r\n  }\r\n\r\n  metadataHandler(resource) {\r\n    let {\r\n      dataset,\r\n      resource: updatedResource,\r\n    } = this.mapResourceToDatapackageResource(resource);\r\n    this.setState({\r\n      dataset,\r\n      resource: updatedResource,\r\n      tablePreviewSample: resource.tablePreviewSample,\r\n      tablePreviewColumns: resource.tablePreviewColumns,\r\n    });\r\n  }\r\n\r\n  mapResourceToDatapackageResource(fileResource) {\r\n    let dataset = { ...this.state.dataset };\r\n    let resource = {};\r\n\r\n    resource[\"bytes\"] = fileResource.size;\r\n    resource[\"hash\"] = fileResource.hash;\r\n    resource[\"format\"] = fileResource.format;\r\n    resource[\"schema\"] = fileResource.schema;\r\n    resource[\"encoding\"] = fileResource.encoding;\r\n    resource[\"mediatype\"] = \"text/csv\"\r\n    resource[\"name\"] = fileResource.name;\r\n    resource[\"dialect\"] = fileResource.dialect;\r\n    resource[\"path\"] = fileResource.path;\r\n    resource[\"hashcopy\"] = fileResource.hashCopy;\r\n\r\n    if (Object.keys(dataset).includes(\"resources\")) {\r\n      dataset.resources.push(resource);\r\n    } else {\r\n      dataset[\"resources\"] = [resource];\r\n    }\r\n    resource[\"sample\"] = fileResource.sample;\r\n    return { dataset, resource };\r\n  }\r\n\r\n  //set state of rich type field. If all rich type fields have been filled,\r\n  // then activate the next button in the Table Schema screen\r\n  handleRichTypeCount = (unfilledRichTypes) => {\r\n    if (unfilledRichTypes <= 0) {\r\n      this.setState({\r\n        richTypeFilled: true,\r\n      });\r\n    } else {\r\n      this.setState({\r\n        richTypeFilled: false,\r\n      });\r\n    }\r\n  };\r\n\r\n  handleChangeMetadata = (event) => {\r\n    const target = event.target;\r\n    const value = target.value;\r\n    const name = target.name;\r\n    const dataset = { ...this.state.dataset };\r\n\r\n    if ([\"tags\", \"years_included\"].includes(name)) {\r\n      const vals = value.split(\",\");\r\n      const values = vals.map((val) => val.trim());\r\n      dataset[name] = Array.from(new Set(values));\r\n    } else if ([\"disaggregation\", \"budget_stage\"].includes(name)) {\r\n      let currentVals = dataset[name] || [];\r\n      if (!target.checked) {\r\n        currentVals = currentVals.filter((val) => val != value); //remove value\r\n        dataset[name] = currentVals;\r\n      } else {\r\n        if (!currentVals.includes(value)) {\r\n          //only add value if it is unique\r\n          currentVals.push(value);\r\n          dataset[name] = currentVals;\r\n        }\r\n      }\r\n    } else {\r\n      dataset[name] = value;\r\n    }\r\n    this.setState({\r\n      dataset,\r\n    });\r\n  };\r\n\r\n  mapDatasetToFiscalFormat = (resource) => {\r\n    const dataset = { ...this.state.dataset };\r\n    let model;\r\n    let schema;\r\n    if (dataset.resources.length > 1) {\r\n      //There's an existing resource, get schema and model\r\n      model = dataset.resources[0].model;\r\n      schema = dataset.resources[0].schema;\r\n      resource.schema = schema;\r\n      resource.model = model;\r\n    } else {\r\n      //first resource, generate schema and model\r\n      resource.schema.fields.forEach((f) => {\r\n        f.type = f.columnType;\r\n        delete f.columnType; //os-types requires type to be of rich type and will not accept the property columnType\r\n      });\r\n      let fdp = new TypeProcessor().fieldsToModel(resource[\"schema\"][\"fields\"]);\r\n      resource.schema.fields = Object.values(fdp.schema.fields);\r\n      resource.model = fdp.model;\r\n    }\r\n\r\n    const resources = dataset.resources.map((res) => {\r\n      if (res.hash == resource.hash) {\r\n        return resource;\r\n      } else {\r\n        return res;\r\n      }\r\n    });\r\n\r\n    this.setState({\r\n      dataset: { ...dataset, resources },\r\n    });\r\n  };\r\n\r\n  downloadDatapackage = async () => {\r\n    fileDownload(JSON.stringify(this.state.dataset), \"datapackage.json\");\r\n  };\r\n\r\n  deleteResource = (hash) => {\r\n    const { dataset } = { ...this.state };\r\n    if (window.confirm(\"Are you sure you want to delete this resource?\")) {\r\n      const temp_dataset = { ...dataset };\r\n      let path;\r\n      if (temp_dataset.resources.length == 1) {\r\n        path = temp_dataset.resources[0].path;\r\n        temp_dataset.resources = [];\r\n      } else {\r\n        const newResource = temp_dataset.resources.filter((resource) => {\r\n          if (resource.hash == hash) {\r\n            path = resource.path;\r\n          }\r\n          return resource.hash != hash;\r\n        });\r\n        temp_dataset.resources = newResource;\r\n      }\r\n      axios({\r\n        method: \"delete\",\r\n        url: `/api/dataset/${temp_dataset.name}`,\r\n        data: {\r\n          metadata: temp_dataset,\r\n          path,\r\n        },\r\n      })\r\n        .then((response) => {\r\n          this.setState({ dataset: temp_dataset, resource: {} });\r\n          alert(\"Resource has been removed successfully\");\r\n        })\r\n        .catch((error) => {\r\n          console.log(error);\r\n          alert(\"Error when removing resource!\");\r\n        });\r\n    }\r\n  };\r\n\r\n  setLoading = (isLoading) => {\r\n    this.setState({\r\n      ui: { ...this.state.ui, loading: isLoading },\r\n    });\r\n  };\r\n\r\n  handleUploadStatus = (status) => {\r\n    const { ui } = this.state;\r\n    const newUiState = {\r\n      ...ui,\r\n      success: status.success,\r\n      error: status.error,\r\n      loading: status.loading,\r\n      errorMsg: status.errorMsg,\r\n    };\r\n    this.setState({ ui: newUiState });\r\n    if (status.success && !status.loading) {\r\n      this.nextScreen();\r\n    } else if (!status.success && status.error) {\r\n      this.prevScreen();\r\n    }\r\n\r\n    //clears error message after 15 seconds\r\n    setTimeout(() => {\r\n      this.setState({ ui: { ...this.state.ui, errorMsg: \"\" } });\r\n    }, 15000);\r\n  };\r\n\r\n  onChangeResourceId = (resourceId) => {\r\n    this.setState({ resourceId });\r\n  };\r\n\r\n  nextScreen = () => {\r\n    let currentStep = this.state.currentStep;\r\n    if (currentStep == 3) {\r\n      this.mapDatasetToFiscalFormat({ ...this.state.resource }); //generate model and fiscal schema as soon as richtypes have been updated.\r\n    }\r\n    let newStep = currentStep + 1;\r\n    this.setState({ currentStep: newStep });\r\n  };\r\n\r\n  prevScreen = () => {\r\n    let newStep = this.state.currentStep - 1;\r\n    this.setState({ currentStep: newStep });\r\n  };\r\n\r\n  handleSaveDataset = async () => {\r\n    this.setState({ saveButtonText: \"Saving...\" });\r\n    axios({\r\n      method: \"post\",\r\n      url: `/api/dataset/${this.state.dataset.name}`,\r\n      data: {\r\n        metadata: this.state.dataset,\r\n        description: this.state.dataset.description,\r\n      },\r\n    })\r\n      .then((response) => {\r\n        this.setState({ saveButtonText: \"Save\" });\r\n        this.setState({ currentStep: 0 });\r\n        alert(\"Uploaded Sucessfully\");\r\n        \r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n        alert(\"Error on upload dataset!\");\r\n      });\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"App\">\r\n        <div>\r\n          <h1 className=\"errorMsg\">{this.state.ui.errorMsg}</h1>\r\n        </div>\r\n        {this.state.currentStep > 0 && (\r\n          <img src={ReactLogo} width=\"50%\" className=\"Img\" />\r\n        )}\r\n        <form\r\n          className=\"upload-wrapper\"\r\n          onSubmit={(event) => {\r\n            event.preventDefault();\r\n            return this.handleSaveDataset();\r\n          }}\r\n        >\r\n          {this.state.currentStep == 0 && (\r\n            <>\r\n              <ResourceList\r\n                dataset={this.state.dataset}\r\n                addResourceScreen={this.nextScreen}\r\n                deleteResource={this.deleteResource}\r\n              />\r\n            </>\r\n          )}\r\n\r\n          {this.state.currentStep == 1 && (\r\n            <div>\r\n              <div className=\"upload-header\">\r\n                <h1 className=\"upload-header__title_h1\">\r\n                  Provide your data file\r\n                </h1>\r\n                <h2 className=\"upload-header__title_h2\">\r\n                  Supported format: CSV\r\n                </h2>\r\n              </div>\r\n\r\n              <Upload\r\n                client={this.state.client}\r\n                resource={this.state.resource}\r\n                metadataHandler={this.metadataHandler}\r\n                datasetId={this.state.datasetId}\r\n                handleUploadStatus={this.handleUploadStatus}\r\n                organizationId={\"gift-data\"}\r\n                authToken={this.props.config.authToken}\r\n                lfsServerUrl={this.props.config.lfsServerUrl}\r\n                dataset={this.state.dataset}\r\n              />\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"upload-edit-area\">\r\n            {this.state.resource.sample && this.state.currentStep == 2 && (\r\n              <>\r\n                <div className=\"upload-header\">\r\n                  <h1 className=\"upload-header__title_h1\">\r\n                    Preview of your dataset\r\n                  </h1>\r\n                </div>\r\n                <TablePreview\r\n                  columns={this.state.tablePreviewColumns}\r\n                  data={this.state.tablePreviewSample}\r\n                />\r\n              </>\r\n            )}\r\n            {this.state.resource.schema && this.state.currentStep == 3 && (\r\n              <>\r\n                <div className=\"upload-header\">\r\n                  <h1 className=\"upload-header__title_h1\">\r\n                    Describe your dataset\r\n                  </h1>\r\n                </div>\r\n                <TableSchema\r\n                  dataset={this.state.dataset}\r\n                  schema={this.state.resource.schema}\r\n                  data={this.state.tablePreviewSample || []}\r\n                  handleRichType={this.handleRichTypeCount}\r\n                />\r\n              </>\r\n            )}\r\n            {this.state.currentStep == 4 && !this.state.savedDataset && (\r\n              <>\r\n                <div className=\"upload-header\">\r\n                  <h1 className=\"upload-header__title_h1\">Describe Metadata</h1>\r\n                </div>\r\n                <Metadata\r\n                  dataset={this.state.dataset}\r\n                  handleChange={this.handleChangeMetadata}\r\n                />\r\n              </>\r\n            )}\r\n            <div>\r\n              {this.state.currentStep == 4 &&\r\n                !this.state.isResourceEdit &&\r\n                this.state.resource && (\r\n                  <button className=\"btn-save\" type=\"submit\">\r\n                    {this.state.saveButtonText}\r\n                  </button>\r\n                )}\r\n              {this.state.currentStep == 4 &&\r\n                !this.state.isResourceEdit &&\r\n                this.state.resource && (\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"btn-download\"\r\n                    onClick={this.downloadDatapackage}\r\n                  >\r\n                    Download Package\r\n                  </button>\r\n                )}\r\n            </div>\r\n          </div>\r\n        </form>\r\n\r\n        <div className=\"resource-edit-actions\">\r\n          {this.state.ui.success && this.state.currentStep == 2 && (\r\n            <button className=\"btn\" onClick={this.nextScreen}>\r\n              Next\r\n            </button>\r\n          )}\r\n\r\n          {this.state.currentStep == 3 ? (\r\n            this.state.richTypeFilled ? (\r\n              <button className=\"btn\" onClick={this.nextScreen}>\r\n                Next\r\n              </button>\r\n            ) : (\r\n              <button disabled={true} className=\"btn\">\r\n                Next\r\n              </button>\r\n            )\r\n          ) : (\r\n            \"\"\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n/**\r\n * If the parent component doesn't specify a `config` and scope prop, then\r\n * the default values will be used.\r\n * */\r\nDatasetEditor.defaultProps = {\r\n  config: {\r\n    authorizedApi: \"/api/authorize/\",\r\n    lfsServerUrl: \"https://localhost:6000\",\r\n    dataset: {},\r\n    metastoreApi: \"/api/dataset/\",\r\n  },\r\n};\r\n\r\nDatasetEditor.propTypes = {\r\n  config: PropTypes.object.isRequired,\r\n};\r\n\r\nexport default DatasetEditor;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./assets/main.css\";\r\nimport App from \"./App\";\r\n// import * as data from './data.json';\r\n// import { metadataEmpty, metadataSingle, metadataDouble } from \"./data/metadata\";\r\n\r\n// Automatically mount the app if an element with id='ResourceEditor' exists\r\nconst element = document.getElementById(\"ResourceEditor\");\r\nif (element) {\r\n  const config = {\r\n    authorizedApi: \"/api/authorize\",\r\n    lfsServerUrl: \"https://giftless-gift.herokuapp.com\",\r\n    dataset: {}, //for test purpose, suppose to be provided by portal\r\n    metastoreApi: \"/api/dataset\",\r\n    skipUpload: false //skip to the metadata screen\r\n  };\r\n\r\n  ReactDOM.render(\r\n    <React.StrictMode>\r\n      <App config={config} />\r\n    </React.StrictMode>,\r\n    element\r\n  );\r\n}\r\n"],"sourceRoot":""}